---
import { getCollection } from "astro:content";
import PresentationCard from "@/components/PresentationCard.astro";
import RootLayout from "@/layouts/RootLayout.astro";
import { SITE_METADATA } from '@/consts';

const talks = await getCollection("talks");
const sortedTalks = talks.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<RootLayout title={SITE_METADATA.title}>
    <div class="section-container animate-fade-in">
        <div class="max-w-7xl mx-auto">
            <div class="mb-12">
                <p class="section-title">Speaking</p>
                <h1 class="text-4xl md:text-5xl font-bold mb-6">
                    Conference <span class="text-primary-500">Talks</span>
                </h1>
                <p class="text-xl text-dark-text-secondary max-w-2xl">
                    Recent and upcoming talks and workshops given around the world
                </p>
            </div>

            <div class="overflow-x-auto">
                <div class="card overflow-hidden">
                    <table class="min-w-full divide-y divide-dark-border">
                        <thead class="bg-dark-surface">
                            <tr>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-dark-text-secondary uppercase tracking-wider">
                                    Presentation
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-dark-text-secondary uppercase tracking-wider">
                                    Conference / Meetup
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-dark-text-secondary uppercase tracking-wider">
                                    Region
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-dark-text-secondary uppercase tracking-wider">
                                    Date
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-dark-text-secondary uppercase tracking-wider">
                                    Watch
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-dark-border">
                            {sortedTalks.map(({ id, data }) => (
                                <PresentationCard
                                    key={id}
                                    image={data.image}
                                    presentation={data.presentation}
                                    conference={data.conference}
                                    region={data.region}
                                    date={new Date(data.date).toLocaleDateString("en-US", {
                                        year: "numeric",
                                        month: "long",
                                        day: "numeric",
                                    })}
                                    link={data.link}
                                />
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</RootLayout>